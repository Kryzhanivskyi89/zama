<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Confidential Client Filter — Zama FHEVM</title>
  <link rel="stylesheet" href="./index.css" />

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Confidential Client Filter</h1>
        <p class="lead">Single-user demo — submit encrypted corporate flag & turnover, compute filter & decrypt (Zama FHEVM).</p>
      </div>
      <div>
        <button id="btnConnect">Connect Wallet</button>
      </div>
    </header>

    <!-- Submit client -->
    <section class="card">
      <h2 style="margin:0;font-size:16px">1. Submit your encrypted client profile</h2>
      <p style="color:var(--muted);margin:6px 0 12px">We store only encrypted fields on-chain: <strong>isCorporate</strong> (bool) and <strong>turnover</strong> (uint64).</p>

      <label>Is corporate?</label>
      <select id="isCorporate">
        <option value="1">Yes (corporate)</option>
        <option value="0">No (individual)</option>
      </select>

      <label>Turnover (units)</label>
      <input id="turnover" type="number" min="0" value="100000" />

      <div class="row">
        <button id="btnSubmitClient">Submit Encrypted Profile</button>
        <button id="btnClear" class="secondary">Clear</button>
      </div>

      <div id="submitStatus" class="status" style="display:none"></div>
      <pre id="clientInfo" style="display:none">Client ID: —\nOwner: —\nHandle(s): —</pre>
    </section>

    <!-- Compute filter -->
    <section class="card">
      <h2 style="margin:0;font-size:16px">2. Compute confidential filter</h2>
      <p style="color:var(--muted);margin:6px 0 12px">Filter: <strong>isCorporate AND turnover &ge; threshold</strong>. Threshold is encrypted before call.</p>

      <div class="row">
        <div class="col">
          <label>Client ID</label>
          <input id="clientIdCompute" type="number" min="1" value="1" />
        </div>
        <div class="col">
          <label>Threshold (units)</label>
          <input id="threshold" type="number" min="0" value="50000" />
        </div>
      </div>

      <div class="row">
        <button id="btnCompute">Compute Filter</button>
        <button id="btnGetHandle" class="secondary">Get Handle</button>
      </div>

      <div id="computeStatus" class="status" style="display:none"></div>
      <pre id="handleOutput" style="display:none"></pre>
    </section>

    <!-- Make public & decrypt -->
    <section class="card">
      <h2 style="margin:0;font-size:16px">3. Make public & decrypt</h2>
      <p style="color:var(--muted);margin:6px 0 12px">If the owner makes the result public, anyone can call the relayer to decrypt a bytes32 handle.</p>

      <div class="row">
        <div class="col">
          <label>Client ID</label>
          <input id="clientIdDecrypt" type="number" min="1" value="1" />
        </div>
        <div class="col">
          <label>Handle (bytes32)</label>
          <input id="manualHandle" type="text" placeholder="0x... (or press Get Handle)" />
        </div>
      </div>

      <div class="row" style="margin-top:12px">
        <button id="btnMakePublic">Make Filter Public (owner only)</button>
        <button id="btnDecrypt" class="secondary">Decrypt Public Handle</button>
      </div>

      <div id="decryptStatus" class="status" style="display:none"></div>
      <pre id="decryptResult" style="display:none"></pre>
    </section>

    <footer>
      <div>Contract: <strong id="contractAddr">0xF71aB6dCfC694F5620420BeFA837e182C202dD12</strong></div>
      <div style="margin-top:6px">Docs / whitepaper: <a class="doc" href="/mnt/data/fhevm_whitepaper_new.pdf" target="_blank">fhevm_whitepaper_new.pdf</a></div>
    </footer>
  </div>

  <script type="module" src="index.js"></script>
</body>
</html>
