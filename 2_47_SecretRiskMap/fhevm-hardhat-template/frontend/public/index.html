<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Secret Risk Map â€” Geo Game (Zama FHEVM)</title>
  <link rel="stylesheet" href="./index.css" />

</head>
<body>
  <div class="app-shell">
    <header class="app-header">
      <div class="header-icon">ðŸ§­</div>
      <div class="header-main">
        <h1 class="app-title">Secret Risk Map â€” Geo Game</h1>
        <p class="app-subtitle">
          Players send encrypted coordinates. The contract classifies only the zone: safe, risky, or dangerous.
        </p>
      </div>
      <div class="header-pill">FHEVM Â· Hidden geometry</div>
    </header>

    <div class="layout">
      <div>
        <div class="card card--intro">
          <div class="card-header-line">
            <h1>Session &amp; Contract</h1>
            <span class="card-tag">Connection</span>
          </div>
          <p class="card-desc">
            Connect your wallet and bind this map to the deployed Secret Risk Map contract.
          </p>
          <p class="card-meta">
            Contract: <code id="contractAddr">0x45c95A9E1aC44eA30D8F7c6F8628f5e8a5f044CA</code>
          </p>
          <div style="margin-top:10px;">
            <button id="btnConnect" class="btn">Connect Wallet</button>
            <div id="connectStatus" class="status"></div>
          </div>
        </div>

        <div class="card">
          <div class="card-header-line">
            <h2><span class="step">1</span>Submit Encrypted Coordinates</h2>
            <span class="card-tag">Player move</span>
          </div>
          <p class="card-desc">
            Choose coordinates in a 0â€“10&nbsp;000 Ã— 0â€“10&nbsp;000 grid. Only encrypted (X,Y) reach the contract.
          </p>

          <label>X coordinate (0â€“10000)</label>
          <input id="coordX" type="number" min="0" max="10000" value="1500" />

          <label>Y coordinate (0â€“10000)</label>
          <input id="coordY" type="number" min="0" max="10000" value="1500" />

          <div class="row">
            <button id="btnSubmitCoords" class="btn">Encrypt &amp; Submit Coordinates</button>
          </div>
          <div id="coordsStatus" class="status"></div>
          <pre id="coordsHandleOut" style="display:none;">â€”</pre>
        </div>

        <div class="card">
          <div class="card-header-line">
            <h2><span class="step">2</span>Make Zone Public</h2>
            <span class="card-tag">Optâ€‘in reveal</span>
          </div>
          <p class="card-desc">
            After your zone is computed onâ€‘chain, you decide when it becomes visible to others.
          </p>

          <div style="color:#4b5563; font-size:12px; margin-bottom:8px;">
            Only the zone label (safe / risky / dangerous) is exposed â€” not (X,Y).
          </div>

          <div class="row">
            <button id="btnMakePublic" class="btn">Make My Zone Public</button>
          </div>
          <div id="makeStatus" class="status"></div>
        </div>

        <div class="card">
          <div class="card-header-line">
            <h2><span class="step">3</span>Get &amp; Decrypt Zone</h2>
            <span class="card-tag">Public view</span>
          </div>
          <p class="card-desc">
            Fetch the zone handle for any address that opted in, then decrypt the zone label.
          </p>

          <label>Address to check</label>
          <input id="fetchAddr" type="text" placeholder="0x..." />

          <div class="row" style="margin-top:8px;">
            <button id="btnGetHandle" class="btn">Get Zone Handle</button>
            <button id="btnDecrypt" class="btn">Public Decrypt</button>
          </div>
          <div id="decryptStatus" class="status"></div>
          <div id="zoneResult" class="result" style="display:none;"></div>
        </div>
      </div>

      <aside class="map-panel">
        <h3 class="map-title">Zone overview</h3>
        <p class="map-subtitle">
          Illustration only â€” your real (X,Y) never leave encryption. Zones hint how coordinates are classified.
        </p>

        <div class="map-canvas-wrap">
          <div class="map-grid">
            <div class="map-axis"></div>
            <div class="map-zone map-zone--safe"></div>
            <div class="map-zone map-zone--risky"></div>
            <div class="map-zone map-zone--danger"></div>
            <div class="map-axes-label map-axes-label--x">X (0â€“10k)</div>
            <div class="map-axes-label map-axes-label--y">Y (0â€“10k)</div>
          </div>
        </div>

        <div class="map-legend">
          <div class="legend-row">
            <div class="legend-swatch safe"></div>
            <div>
              <div class="legend-label">Safe zone</div>
              <div class="legend-note">Lowâ€‘risk region for hidden coordinates.</div>
            </div>
          </div>
          <div class="legend-row">
            <div class="legend-swatch risky"></div>
            <div>
              <div class="legend-label">Risky zone</div>
              <div class="legend-note">Transitional area â€” medium probability of danger.</div>
            </div>
          </div>
          <div class="legend-row">
            <div class="legend-swatch danger"></div>
            <div>
              <div class="legend-label">Dangerous zone</div>
              <div class="legend-note">Critical region â€” highâ€‘risk coordinates.</div>
            </div>
          </div>
        </div>
      </aside>
    </div>

    <footer>
      Logs printed to console. Local whitepaper: <code>/mnt/data/fhevm_whitepaper_new.pdf</code>
    </footer>
  </div>

<script type="module" src="./index.js"></script>
</body>
</html>
